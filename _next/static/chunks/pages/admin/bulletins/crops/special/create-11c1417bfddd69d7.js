(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4169],{13063:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/special/create",function(){return n(65897)}])},65897:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ne}});var r=n(34051),o=n.n(r),a=n(85893),u=n(67294),i=n(9473),c=n(87682),l=n(30340),s=n(66383),f=n(95243),p=n(30560),d=n(63289),v=n(1029),y=n(16327),b=n(61690),m=n(87006),g=n(901),h=n(72216),_=n(59390),S=n(38885),w=n(77715);function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E,A,P="plant/trans",x="veg/repro",k="mat",L="lprep",R="none",I=(O(E={},L,"Preparation Stage"),O(E,P,"Newly Planted"),O(E,x,"Vegetative/Reproductive"),O(E,k,"Maturing"),E),C=(O(A={},P,"plant"),O(A,x,"grow"),O(A,k,"harv"),O(A,L,"prep"),Object.keys(I).map((function(e){return e.toLowerCase()})),Object.values(I),n(47426));function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=function(e,t){var n=!0;if(!t)throw new Error("Missing crop stages masterlist");if(e.length<2)return!1;for(var r=0;r<e.length;r+=1){if(""===e[r]||!e[r]){n=!1;break}if(e[r]!==R){if(!t[e[r]]){n=!1;break}if(!t[e[r]].label){n=!1;break}}}return n};function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t,n){var r=(0,u.useState)([]),o=r[0],a=r[1];return(0,u.useEffect)((function(){if((null===e||void 0===e?void 0:e.data)&&(null===t||void 0===t?void 0:t.data)&&n.length>0&&0===o.length){var r=e.data.map((function(e){return e.province})).filter((function(e,t,n){return n.indexOf(e)===t})),u=e.data.reduce((function(e,t){return void 0===e[t.province]&&(e[t.province]=[]),e[t.province]=M(e[t.province]).concat(M(t.municipalities)),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){N(e,t,n[t])}))}return e}({},e)}),{}),i=M(n);i.forEach((function(t){t.disabled=!r.includes(t.label),t.municipalities.forEach((function(n){var r=e.data.findIndex((function(e){return e.province===n.province&&e.municipalities.includes(n.label)}));t.disabled?n.disabled=!0:(n.disabled=!u[t.label].includes(n.label),n.signal=r>-1?e.data[r].signal:0)}))})),a(i)}}),[e,t,n,o]),{affectedprovinces:o}}var F=n(22856),G=n(23766),W=n(15497),H=n(94640),Y=n(16013),U=n(27392),V=n(53063),Z=n(12671),K=n(87784);function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,o)}function $(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){X(a,r,o,u,i,"next",e)}function i(e){X(a,r,o,u,i,"throw",e)}u(void 0)}))}}function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){q(e,t,n[t])}))}return e}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],u=!0,i=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);u=!0);}catch(c){i=!0,o=c}finally{try{u||null==n.return||n.return()}finally{if(i)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ee={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,processed:!1,loading:!1,error:"",success:"",sel_condition:{id:0,from:"weather_condition",label:C.MW.WAY_BELOW_NORMAL.label}},te={url:"",filename:""};var ne=(0,f.Z)((function(e){var t=e.user,n=e.onBtnLogoutClick,r=e.loading,f=(0,u.useState)(ee),O=f[0],E=f[1],A=(0,u.useState)([]),P=A[0],x=A[1],k=(0,u.useState)([]),L=k[0],I=k[1],T=(0,H.Z)(O.sel_province,O.sel_municipality),N=T.loading,M=T.error,J=T.summary,X=Q((0,c.ky)(v.K.GLOBAL_COLLECTIONS,v.K.CYCLONE_ADVISORY),2),q=X[0],ne=X[1],re=Q((0,c.ky)(p.M.WEATHER_FORECASTS,"".concat("bicol","/").concat(p.M.SUB_SPECIAL_COMMON,"/").concat(p.M.COMMON_SPECIAL_TYPE.WIND_SPEED)),2),oe=re[0],ae=re[1],ue=(0,c.Kx)("".concat(d.o.CROP_REC_SMS_LIST,"special_sms"),"id",null,1).documents,ie=(0,u.useMemo)((function(){var e,t,n;return(null===ue||void 0===ue?void 0:ue.length)>0&&q?ue[0].sms.replace("{{special_weather_name_identifier}}",null!==(n=null===q||void 0===q||null===(e=q.data)||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.typhoon_name)&&void 0!==n?n:"-"):null}),[ue,q]),ce=B(oe,q,P).affectedprovinces,le=(0,G.Z)(O.sel_province,ce),se=(0,_.Z)(O.sel_province,O.sel_crop),fe=se.cropcalendar,pe=se.cropStages,de=se.loading,ve=se.error,ye=(0,S.Z)().cropList.map((function(e,t){return{disabled:!1,label:e,id:t}})),be=function(e){var t=e.calendarProvince,n=void 0===t?null:t,r=e.municipality,o=void 0===r?null:r,a=e.dateStart,i=void 0===a?null:a,c=e.crop,l=void 0===c?null:c,s=e.isTendayRange,f=void 0!==s&&s,p=e.allStages,d=void 0===p?null:p,v=(0,u.useState)([]),y=v[0],b=v[1],m=(0,u.useState)(""),g=m[0],h=m[1],_=function(){b([]),h("")},S=(0,u.useMemo)((function(){var e=new Date(i);return(0,w.Mn)(e,f)}),[i,f]);return(0,u.useEffect)((function(){if(_(),n){if(Array.isArray(n))return;if(Array.isArray(d))return;if(n.data1[0].crop!==l||n.data2[0].crop!==l)return;try{var e=n.data1.find((function(e){return e.municipality===o})),t=n.data2.find((function(e){return e.municipality===o}));if(!e||!t)throw new Error("Cannot find cropping calendar");var r,a=0,u=0,i=[],c=(j(r={},C.Vs.FIRST_HALF,0),j(r,C.Vs.SECOND_HALF,1),r),s=function(e,t,n){if(e!==R){var r={id:i.length,label:d[e].label,code:e,municipality:t,part:n};i.findIndex((function(t){return t.code===e}))>=0||i.push(r)}};for(var f in S){var p=e[f],v=t[f];if(""==="".concat(null!==p&&void 0!==p?p:"").concat(null!==v&&void 0!==v?v:""))throw new Error("Crop stages data for ".concat(f," does not exist."));var y=p.split(","),m=v.split(",");if(!D(y,d)||!D(m,d))throw new Error("Invalid set of crop stages for month: ".concat(f));for(var g=0;g<S[f].length;g+=1){var w=c[S[f][g]];u+=1,s(y[w],e.municipality,"".concat(f," - ").concat(S[f][g])),s(m[w],t.municipality,"".concat(f," - ").concat(S[f][g])),y[w]===R&&m[w]===R&&(a+=1)}}if(a===u)throw new Error("No crop stages are available");b(i)}catch(O){_(),h(O.message)}}}),[n,o,d,l,S]),{uniquecropstages:y,error:g}}({calendarProvince:fe,municipality:O.sel_municipality,dateStart:(0,w.aV)(!1),crop:O.sel_crop,allStages:pe}),me=be.uniquecropstages,ge=be.error,he=(0,F.Z)(null,L,O.sel_crop,Y.q.SPECIAL,!0,!0),_e=he.recommendations,Se=he.farmoperations,we=he.loading,Oe=he.error,Ee=(0,W.Z)(_e,pe,L),Ae=Ee.group,Pe=Ee.error,xe=(0,i.v9)((function(e){return e.reports})),ke=xe.status,Le=xe.report,Re=(0,i.v9)((function(e){return e.dashboard.reportType})),Ie=(0,i.v9)((function(e){return e.dashboard.isEnglish})),Ce=(0,u.useState)(!0),je=Ce[0],De=Ce[1],Te=(0,u.useState)(!1),Ne=Te[0],Me=Te[1],Be=(0,u.useRef)(!1),Fe=(0,u.useState)(te),Ge=Fe[0],We=Fe[1],He=(0,u.useState)(U.BF),Ye=He[0],Ue=He[1],Ve=(0,i.I0)();(0,u.useEffect)((function(){Be.current=!0;var e=function(){var e=$(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.$m)();case 3:t=e.sent,Be&&x(t.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){Be.current=!1}}),[]),(0,u.useEffect)((function(){Ve((0,h.nS)()),Ve((0,Z.s_)())}),[Ve]),(0,u.useEffect)((function(){null!==J&&E((function(e){return z({},e,{sel_month:{label:(0,w.aV)()}})}))}),[J]),(0,u.useEffect)((function(){De(r||de||we||N||ne===g.G.PENDING||ae===g.G.PENDING)}),[r,de,we,N,ne,ae]),(0,u.useEffect)((function(){We(te)}),[Ie]),(0,u.useEffect)((function(){if(""!==ve||""!==Oe||""!==M||""!==ge){var e=ve||Oe||M||ge;E((function(t){return z({},t,{error:e})}))}else E((function(e){return z({},e,{error:""})}))}),[ge,Oe,M,ve]),(0,u.useEffect)((function(){ke===g.G.FULLFILLED&&null!==Le&&Be.current&&Ue((function(e){return z({},e,{msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:Le.id})}))}),[ke,Le]),(0,u.useEffect)((function(){Pe||null===Ae||Ve((0,h.Km)(Ae))}),[Ae,Pe,Ve]),(0,u.useEffect)((function(){I(me)}),[me]);var Ze=function(){var e=$(o().mark((function e(){var t,n,r,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===Ge.url){e.next=3;break}return Me(!0),e.abrupt("return");case 3:return E((function(e){return z({},e,{loading:!0,error:"",success:""})})),e.prev=4,t={region:"bicol",province:O.sel_province,municipality:O.sel_municipality,date:(new Date).toDateString(),operation:"preview",language:Ie?"en":"tag",crop:O.sel_crop},Me(!0),E((function(e){return z({},e,{loading:!0,error:""})})),e.next=10,(0,m.U1)(t);case 10:n=e.sent,r=new Blob([n],{type:"application/pdf"}),(a={}).href=URL.createObjectURL(r),a.download="".concat(O.sel_province,"_").concat(O.sel_municipality,".pdf"),We((function(e){return z({},e,{url:a.href,filename:a.download})})),E((function(e){return z({},e,{loading:!1,success:"Bulletin preview created."})})),e.next=25;break;case 19:return e.prev=19,e.t0=e.catch(4),e.next=23,(0,K.fu)(e.t0);case 23:u=e.sent,E((function(e){return z({},e,{loading:!1,error:u})}));case 25:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=$(o().mark((function e(){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ue(z({},Ye,{loading:!0,msg:"Saving report..."}));try{n={region:"bicol",province:O.sel_province,municipality:O.sel_municipality,date:(new Date).toDateString(),operation:"create",language:Ie?"en":"tag",crop:O.sel_crop},Ve((0,b.tR)(n)).unwrap().then((function(){Re!==U.Ry.SPECIAL_WEATHER&&(Ve((0,V.uq)(U.Ry.SPECIAL_WEATHER)),Ve((0,b.RC)({uid:t.uid,type:U.Ry.SPECIAL_WEATHER})))})).catch((function(e){Be.current&&Ue((function(t){return z({},t,{msg:e,loading:!1,savesuccess:!1,docId:null})}))}))}catch(a){r="",void 0!==a.response&&(r=void 0!==a.response.data&&"[object Blob]"===((o=a.response.data)&&"undefined"!==typeof Symbol&&o.constructor===Symbol?"symbol":typeof o)?a.response.data:""),""===r&&(r=a.message),E((function(e){return z({},e,{loading:!1,error:r})}))}case 2:case"end":return e.stop()}var o}),e)})));return function(){return e.apply(this,arguments)}}();return(0,a.jsx)(s.Z,{loading:r,user:t,onBtnLogoutClick:n,accLevel:C.DW.ADMIN,children:(0,a.jsx)(l.Z,{optsprovinces:ce,optsmunicipalities:le,optscrops:ye,optscropstages:L,optsactivities:Se,sel_options:O,loading:je,isloadingreport:ke===g.G.PENDING,isdisabled:!1===(null===q||void 0===q?void 0:q.has_cyclone),open:Ne,message:Ye,smstext:ie,pageTitle:"Special Weather Bulletin",pageDescription:"Create <strong>Special Weather</strong> crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download.",pdfPreview:Ge,onSelectItemChange:function(e,t){var n=t.from,r=t.label;if(We(te),Ve((0,h.nS)()),""!==O.error&&E((function(e){return z({},e,{error:""})})),Object.keys(t).includes("id"))switch(n){case"province":I([]),E((function(e){return z({},e,{sel_province:r,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null})}));break;case"municipality":I([]),E((function(e){return z({},e,{sel_municipality:r,sel_crop:null,sel_stage:null,sel_activity:null})}));break;case"crop":E((function(e){return z({},e,{sel_crop:r,sel_stage:null,sel_activity:null})})),I([])}else if("province"===n){var o=O.sel_month;E(z({},ee,{sel_month:o})),I([])}else"municipality"===n&&(E(z({},O,{sel_municipality:null,sel_crop:null,sel_day:null,sel_stage:null,sel_activity:null})),I([]))},handlePreview:Ze,handleSave:Ke,toggleViewerOpen:function(){Me((function(e){return!e}))},resetSelections:function(){var e=O.sel_month;E(z({},ee,{sel_month:e})),I([]),Ve((0,h.nS)())},togglePrompt:function(){Ue((function(e){return z({},U.BF,{isOpen:!e.isOpen})}))}})})}))},87682:function(e,t,n){"use strict";n.d(t,{ky:function(){return v},Kx:function(){return y},m$:function(){return b},tl:function(){return m}});var r=n(34051),o=n.n(r),a=n(67294),u=n(25321),i=n(96772);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){l(a,r,o,u,i,"next",e)}function i(e){l(a,r,o,u,i,"throw",e)}u(void 0)}))}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}function d(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){var n=(0,a.useState)(null),r=n[0],c=n[1],l=(0,a.useState)(!0),f=l[0],p=l[1],d=(0,a.useState)(""),v=d[0],y=d[1],b=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var n=function(){var n=s(o().mark((function n(){var r,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=(0,u.JU)(i.db,e,t),n.next=4,(0,u.QT)(r);case 4:(a=n.sent).exists()&&b.current&&(c(a.data()),p(!1)),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),y(n.t0.message),p(!1);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return b.current=!1}}),[e,t]),[r,f,v]}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=(0,a.useState)([]),l=c[0],f=c[1],v=(0,a.useState)(!0),y=v[0],b=v[1],m=(0,a.useState)(""),g=m[0],h=m[1],_=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var a=function(){var a=s(o().mark((function a(){var c,l,s,v;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,c=[(0,u.Xo)(t,"asc")],r>0&&c.push((0,u.b9)(r)),l=(0,u.hJ)(i.db,e),s=n||u.IO.apply(void 0,[l].concat(d(c))),o.next=7,(0,u.PL)(s);case 7:v=o.sent,_.current&&(f(v.docs.map((function(e){return p({},e.data())}))),b(!1)),o.next=15;break;case 11:o.prev=11,o.t0=o.catch(0),h(o.t0.message),b(!1);case 15:case"end":return o.stop()}}),a,null,[[0,11]])})));return function(){return a.apply(this,arguments)}}();return a(),function(){return _.current=!1}}),[e,t,n,r]),{documents:l,loading:y,error:g}}function b(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c=(0,a.useState)([]),l=c[0],f=c[1],d=(0,a.useState)(!0),v=d[0],y=d[1],b=(0,a.useState)(""),m=b[0],g=b[1],h=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var a=function(){var a=s(o().mark((function a(){var c,l;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,c=(0,u.IO)((0,u.hJ)(i.db,e,t,n),(0,u.Xo)(r)),o.next=4,(0,u.PL)(c);case 4:l=o.sent,h.current&&(f(l.docs.map((function(e){return p({},e.data())}))),y(!1)),o.next=12;break;case 8:o.prev=8,o.t0=o.catch(0),g(o.t0.message),y(!1);case 12:case"end":return o.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}();return a(),function(){return h.current=!1}}),[e,t,n,r]),{documents:l,loading:v,error:m}}function m(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c=arguments.length>4?arguments[4]:void 0,l=(0,a.useState)([]),f=l[0],d=l[1],v=(0,a.useState)(!0),y=v[0],b=v[1],m=(0,a.useState)(""),g=m[0],h=m[1],_=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var a=function(){var a=s(o().mark((function a(){var l,s;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,l=(0,u.hJ)(i.db,e,t,n),""!==r&&(l=(0,u.IO)(l,(0,u.Xo)(r))),c&&(l=(0,u.IO)(l,(0,u.b9)(c))),o.next=6,(0,u.PL)(l);case 6:s=o.sent,_.current&&(d(s.docs.map((function(e){return p({},e.data())}))),b(!1)),o.next=14;break;case 10:o.prev=10,o.t0=o.catch(0),h(o.t0.message),b(!1);case 14:case"end":return o.stop()}}),a,null,[[0,10]])})));return function(){return a.apply(this,arguments)}}();return a(),function(){return _.current=!1}}),[e,t,n,r,c]),{documents:f,loading:y,error:g}}},1029:function(e,t,n){"use strict";n.d(t,{K:function(){return h},d:function(){return _}});var r=n(34051),o=n.n(r),a=n(94763),u=n(96772),i=n(47426),c=n(27392);function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,n,r,o,a,u){try{var i=e[a](u),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){s(a,r,o,u,i,"next",e)}function i(e){s(a,r,o,u,i,"throw",e)}u(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function y(e,t){return!t||"object"!==m(t)&&"function"!==typeof t?l(e):t}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}var m=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}var h={MEDIA_ASSETS:"n_page_media",ASSETS:"n_page_assets",PAGE_SEARCH:"n_page_search",GLOBAL_COLLECTIONS:"w_services",TYPHOON_ADVISORY:"typhoon_advisory",CYCLONE_ADVISORY:"cyclone_advisory"},_=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,e);var t=g(n);function n(){var e;p(this,n);var r=l(e=t.apply(this,arguments));d(l(e),"getPageAssetsDoc",function(){var e=f(o().mark((function e(t,n){var a,u,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>2&&void 0!==i[2]&&i[2],u=[],e.prev=2,e.next=5,r.getDocumentData(h.ASSETS,t);case 5:if(u=e.sent){e.next=8;break}return e.abrupt("return",[]);case 8:if(n){e.next=10;break}return e.abrupt("return",u);case 10:if(!a){e.next=14;break}return e.abrupt("return",u.data.filter((function(e){return e.page===n})));case 14:return e.abrupt("return",u.data.filter((function(e){return e.page===n})).map((function(e){return e.url})));case 15:e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(2),console.error(e.t0.message),new Error(e.t0.message);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,n){return e.apply(this,arguments)}}());var a=l(e);d(l(e),"getTyphoonAdvisory",f(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.doc(a.db,h.GLOBAL_COLLECTIONS,h.TYPHOON_ADVISORY),e.next=3,a.getDoc(t);case 3:if(!(n=e.sent).exists()){e.next=6;break}return e.abrupt("return",n.data());case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)}))));var s=l(e);return d(l(e),"getWeatherForecast",function(){var e=f(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getNestedCollectionData(h.WEATHER_FORECASTS,t,n,"name");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),d(l(e),"getPdfDownloadURL",function(){var e=f(o().mark((function e(t){var n,r,a,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=l.length>1&&void 0!==l[1]?l[1]:c.Ry.SEASONAL,r="",e.t0=n,e.next=e.t0===c.Ry.SEASONAL?5:e.t0===c.Ry.TEN_DAY?7:e.t0===c.Ry.SPECIAL_WEATHER?9:11;break;case 5:return r=i.Do.PDF_STORAGE_SEASONAL,e.abrupt("break",12);case 7:return r=i.Do.PDF_STORAGE_TENDAY,e.abrupt("break",12);case 9:return r=i.Do.PDF_STORAGE_SPECIAL,e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:return e.prev=12,a=(0,u.iH)(u.tO,"".concat(r,"/").concat(t)),e.next=16,(0,u.Jt)(a);case 16:return e.abrupt("return",e.sent);case 19:throw e.prev=19,e.t1=e.catch(12),new Error(e.t1.message);case 22:case"end":return e.stop()}}),e,null,[[12,19]])})));return function(t){return e.apply(this,arguments)}}()),e}return n}(a.Z)}},function(e){e.O(0,[5778,9564,9964,9522,1903,6279,542,7944,6295,1433,6572,1050,3260,3204,3622,9774,2888,179],(function(){return t=13063,e(e.s=t);var t}));var t=e.O();_N_E=t}]);