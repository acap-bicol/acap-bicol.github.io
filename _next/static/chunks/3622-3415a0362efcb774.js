"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3622],{55688:function(e,n,t){var r=t(85893),i=t(67294),o=t(45697),a=t.n(o),l=t(14866),s=t(46901);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=i.forwardRef((function(e,n){return(0,r.jsx)(s.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){c(e,n,t[n])}))}return e}({elevation:6,ref:n,variant:"filled"},e))}));function d(e){var n=e.openSnackbar,t=e.message,o=e.severity,a=e.closeHandlerCB,s=void 0===a?function(){}:a,c=(0,i.useState)(n),d=c[0],p=c[1];(0,i.useEffect)((function(){p(n)}),[n]);var f=function(){p(!1),s()};return(0,r.jsx)(l.Z,{open:d,autoHideDuration:3e3,onClose:f,children:(0,r.jsx)(u,{onClose:f,severity:o,sx:{width:"100%"},children:t})})}d.propTypes={openSnackbar:a().bool,message:a().string,severity:a().string},n.Z=d},30340:function(e,n,t){t.d(n,{Z:function(){return W}});var r=t(85893),i=t(67294),o=t(9473),a=t(11163),l=t(45697),s=t.n(l),c=t(41664),u=t(21023),d=t(76295),p=t(11057),f=t(56863),g=t(87357),m=t(86886),x=t(93946),b=t(61903),h=t(15861),v=t(11829),y=t(19227),j=t(22094),Z=t(98456),w=t(87918),S=t(67720),O=t(40044),C=t(88409),P=t(53063),k=t(901),_=t(24478),E=t(22228),T={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:function(e){return e.spacing(1)},textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},marginTop:function(e){return e.spacing(1)},padding:function(e){return e.spacing(3)}},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:function(e){return e.spacing(1)},width:"100%",padding:function(e){return e.spacing(1)},border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(1)},"& p, ul, ol":{fontSize:"14px"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}}};function D(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){D(e,n,t[n])}))}return e}function F(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function R(e){var n=function(e){var n=e.children,t=e.value,i=e.index,o=F(e,["children","value","index"]);return(0,r.jsx)("div",I({role:"tabpanel",hidden:t!==i,id:"simple-tabpanel-".concat(i),"aria-labelledby":"simple-tab-".concat(i)},o,{children:t===i&&(0,r.jsx)(g.Z,{sx:{p:3,whiteSpace:e.smsstyle},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},a=e.options,l=e.smstext,s=e.sel_options,u=e.optsactivities,d=e.recommendationsData,x=e.loading,b=e.handleSave,v=e.handlePreview,y=e.show,j=void 0===y||y,D=e.isCreateDisabled,R=void 0!==D&&D,z=(0,o.I0)(),A=(0,o.v9)((function(e){return e.recommendations})),L=A.filtered_recommendations,H=A.recommendations,M=(0,E.Z)(null!==d&&void 0!==d?d:H,u).group,B=(0,o.v9)((function(e){return e.reports})),N=B.error,V=B.status,W=(0,o.v9)((function(e){return e.dashboard.isEnglish})),G=(0,i.useState)(0),q=G[0],U=G[1],Y=(0,i.useState)(!1),J=Y[0],X=Y[1];(0,i.useEffect)((function(){X(a.loading||V===k.G.PENDING)}),[a.loading,V]);return(0,r.jsxs)(m.ZP,{container:!0,sx:T.container,gap:3,style:{marginTop:"24px"},children:[(0,r.jsxs)(m.ZP,{item:!0,sx:T.item,xs:12,lg:12,children:[(0,r.jsx)(g.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,r.jsx)(Z.Z,{size:24,color:"primary",sx:{display:x?"block":"none"}})}),null!==L&&j&&(0,r.jsx)(g.Z,{children:(0,r.jsxs)(g.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,r.jsx)(g.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(C.Z,{value:q,onChange:function(e,n){U(n)},"aria-label":"basic tabs example",children:[(0,r.jsx)(O.Z,I({label:"PDF FORM"},t(0))),(0,r.jsx)(O.Z,I({label:"SMS FORM"},t(1)))]})}),(0,r.jsxs)(n,{value:q,index:0,smsstyle:"normal",children:[(0,r.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,r.jsx)(h.Z,{variant:"h4",children:"Impact Outlooks"}),(0,r.jsx)(w.Z,{size:"medium",variant:"outlined",label:W?"Tagalog":"English",onClick:function(){return z((0,P.cX)())},sx:{width:"90px"}})]}),(0,r.jsx)(g.Z,{sx:T.recSeasonal,children:(0,r.jsx)(_.Z,{impactOutlookOnly:!0,isShowImpactOutlookSubtitle:!1,recommendations:M,impactOutlookEng:"impact",impactOutlookTag:"impact_tagalog",title:s.sel_crop,isTagalog:!W,isShowTitle:!1})}),(0,r.jsx)("hr",{}),(0,r.jsx)(h.Z,{variant:"h4",children:"Recommendations"}),Object.keys(L).map((function(e){return Object.keys(L[e]).map((function(n,t){return(0,r.jsxs)(g.Z,{sx:T.recSeasonal,children:[(0,r.jsxs)(h.Z,{variant:"h6",children:[e," - ",n]}),(0,r.jsx)(_.Z,{recommendations:L[e][n],isTagalog:!W,isShowTitle:!1})]},"rec-".concat(t))}))}))]}),(0,r.jsx)(n,{value:q,index:1,smsstyle:"pre-wrap",children:l})]})})]}),(0,r.jsxs)(g.Z,{sx:{marginBottom:"16px",width:"100%",display:null!==L&&j?"block":"none"},children:[(0,r.jsx)("br",{}),(0,r.jsx)(S.Z,{}),(0,r.jsx)("br",{}),""!==N&&(0,r.jsxs)(h.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",N]}),(0,r.jsxs)(f.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,r.jsx)(c.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,r.jsx)(p.Z,{disabled:J,children:"Cancel"})}),(0,r.jsxs)(p.Z,{onClick:v,disabled:J,children:[(0,r.jsx)("span",{style:{display:J?"none":"block"},children:"Preview"})," ","\xa0",(0,r.jsx)(Z.Z,{size:20,color:"secondary",sx:{display:J?"block":"none"}})]}),(0,r.jsx)(p.Z,{variant:"contained",onClick:b,disableElevation:!0,disabled:J||R,children:"Save"})]})]})]})}R.propTypes={options:s().object,smstext:s().string,keyEng:s().string,keyTag:s().string,formTitle:s().string,isCreateDisabled:s().bool,show:s().bool,loading:s().bool,handleSave:s().func,handlePreview:s().func};var z=R,A=t(79316),L=t(55688),H=t(12671),M=t(22757);function B(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){B(e,n,t[n])}))}return e}function V(e){var n=(0,i.useState)(!1),t=n[0],l=n[1],s=(0,a.useRouter)(),Z=(0,o.I0)(),w=e.open,S=e.loading,O=e.isloadingreport,C=e.isdisabled,P=e.climateRisk,k=e.optsprovinces,_=e.optsmunicipalities,E=e.optscrops,T=e.optscropstages,D=e.optsactivities,I=e.recommendationsData,F=e.sel_options,R=e.message,B=e.smstext,V=e.pageTitle,W=void 0===V?"":V,G=e.pageDescription,q=void 0===G?"":G,U=e.pdfPreview,Y=e.handlePreview,J=e.handleSave,X=e.resetSelections,$=e.togglePrompt,K=e.toggleViewerOpen,Q=e.onSelectItemChange,ee=(0,o.v9)((function(e){return e.reports})).report,ne="Invalid year";(0,i.useEffect)((function(){null===F.sel_municipality&&!0===t&&l(!1)}),[F.sel_municipality,t]);var te=function(){ee&&(Z((0,H.s_)()),s.push("/admin/bulletins/crops/report/view/?docId=".concat(ee.id)))},re=function(){var e="Loading...";return k.length>0&&(e=null===F.sel_province?"Select a province":"Province"),e};return(0,r.jsxs)("div",{children:[(0,r.jsx)(y.Z,{isOpen:R.isOpen,maxWidth:"xs",openButtonText:null,title:R.title,contentText:R.msg,loading:R.loading,modalCancelHandlerCB:function(){R.savesuccess?te():$()},modalConfirmHandlerCB:function(){R.savesuccess?te():J()}}),(0,r.jsx)(j.Z,{open:w,pdfPreview:U,error:F.error,loading:F.loading,toggleViewerOpen:K}),(0,r.jsx)(L.Z,{openSnackbar:""!==F.error,message:F.error,severity:"warning"}),(0,r.jsxs)(m.ZP,{container:!0,sx:M.Z.container,children:[(0,r.jsxs)(g.Z,{sx:M.Z.headerText,children:[(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(h.Z,{variant:"h5",children:W}),(0,r.jsx)("p",{dangerouslySetInnerHTML:{__html:q}})]}),(0,r.jsx)(g.Z,{children:(0,r.jsx)(x.Z,{"aria-label":"exit",size:"medium",children:(0,r.jsx)(c.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,r.jsx)(u.Z,{fontSize:"inherit"})})})})]}),(0,r.jsxs)(m.ZP,{item:!0,sx:M.Z.item,xs:12,lg:4,children:[(0,r.jsx)(h.Z,{variant:"h6",children:"Selection Options"}),(0,r.jsx)(d.Z,{disablePortal:!0,id:"province",size:"small",value:F.sel_province,disabled:0===k.length||F.error.includes(ne)||S,options:k,sx:M.Z.autocomplete,PaperComponent:v.Z,renderInput:function(e){return(0,r.jsx)(b.Z,N({},e,{label:re()}))},getOptionDisabled:function(e){return e.disabled},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return Q(e,N({},n,{from:"province"}))}}),(0,r.jsx)(d.Z,{disablePortal:!0,id:"municipality",size:"small",value:F.sel_municipality,disabled:0===_.length||F.error.includes(ne)||S,options:_,sx:M.Z.autocomplete,PaperComponent:v.Z,renderInput:function(e){return(0,r.jsx)(b.Z,N({},e,{label:null===F.sel_municipality?"Select a municipality":"Municipality"}))},getOptionDisabled:function(e){return e.disabled||void 0!==e.iscalendar},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){Q(e,N({},n,{from:"municipality"})),l(!1)}}),(0,r.jsx)(d.Z,{disablePortal:!0,id:"crop",size:"small",value:F.sel_crop,disabled:0===E.length||S||!F.sel_municipality,options:E,sx:M.Z.autocomplete,PaperComponent:v.Z,renderInput:function(e){return(0,r.jsx)(b.Z,N({},e,{label:null===F.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){Q(e,N({},n,{from:"crop"})),l(!1)}}),null!==F.sel_municipality&&(0,r.jsxs)("div",{style:{marginTop:"16px",float:"left",textAlign:"center",border:"1px solid #DCEDC8",padding:"5px 10px",borderRadius:"5px"},children:[(0,r.jsx)(h.Z,{variant:"subtitle1",children:(0,r.jsx)("strong",{children:"Climate Risk:"})}),P]}),(0,r.jsxs)(f.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:O||null===F.sel_municipality||"-"===F.sel_crop,sx:{marginTop:"16px",float:"right"},children:[(0,r.jsx)(p.Z,{variant:"outlined",disabled:S||O,onClick:X,children:"Reset"}),(0,r.jsx)(p.Z,{variant:"contained",onClick:function(){return l((function(e){return!e}))},disabled:S||null===F.sel_month||0===T.length||""!==F.error||t,children:"Generate"})]})]}),(0,r.jsx)(m.ZP,{item:!0,sx:M.Z.item,xs:12,lg:8,children:(0,r.jsx)(A.Z,{climateRisk:P,selecteditems:F,cropstages:null===T||void 0===T?void 0:T.map((function(e){return e.label})).toString().split(",").join(", "),farmoperations:D.map((function(e){return e.label})).toString().split(",").join(", "),loading:S,reportType:"tenday"})})]}),(0,r.jsx)(z,{show:t,loading:S,keyEng:"practice",keyTag:"practice_tagalog",sel_options:F,recommendationsData:I,optsactivities:D,options:F,smstext:B,isCreateDisabled:C,handlePreview:Y,toggleViewerOpen:K,pdfPreview:U,handleSave:$})]})}V.propTypes={climateRisk:s().string,optsprovinces:s().array,optsmunicipalities:s().array,optscrops:s().array,optscropstages:s().array,optsactivities:s().array,sel_options:s().object,loading:s().bool,isloadingreport:s().bool,isdisabled:s().bool,open:s().bool,message:s().object,smstext:s().string,pageTitle:s().string,pageDescription:s().string,pdfPreview:s().object,onSelectItemChange:s().func,handlePreview:s().func,handleSave:s().func,toggleViewerOpen:s().func,resetSelections:s().func,togglePrompt:s().func};var W=V},94640:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(67294),i=t(9473),o=t(47426),a=t(56867),l=t(77715),s=t(901);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,n){var t=(0,r.useState)([]),c=t[0],d=t[1],p=(0,r.useState)(null),f=p[0],g=p[1],m=(0,r.useState)(""),x=m[0],b=m[1],h=(0,r.useState)(""),v=h[0],y=h[1],j=(0,r.useState)(!1),Z=j[0],w=j[1],S=(0,i.I0)(),O=(0,i.v9)((function(e){return e.tendayweather})),C=O.ids,P=O.status,k=O.entities,_=O.error;return(0,r.useEffect)((function(){null!==e&&(b(""),y(""),S((0,a.R)(e)))}),[e,S]),(0,r.useEffect)((function(){b(_)}),[_]),(0,r.useEffect)((function(){w(P===s.G.PENDING)}),[P]),(0,r.useEffect)((function(){if(b(""),y(""),P===s.G.FULLFILLED&&C.length>0&&""===_&&null!==n){var e=Object.values(k).find((function(e){return e.municipality===n}));if(void 0!==e){var t,r,i=JSON.parse(e.data),a=Object.values(o.MW);d(i.reduce((function(e,n,o){var s,c,d;return u(e).concat([{id:o,label:n.day_format,label_full:null===(s=(0,l.Ay)(n.day_format,i[9].day_format))||void 0===s?void 0:s.toDateString(),rainfall:n.rainfall,forecast:null!==(t=null===(c=a.find((function(e){return e.tenday===n.rainfall})))||void 0===c?void 0:c.sync)&&void 0!==t?t:"-",code:null!==(r=null===(d=a.find((function(e){return e.tenday===n.rainfall})))||void 0===d?void 0:d.label)&&void 0!==r?r:"-"}])}),[]));var c=new Date(1e3*i[0].date_start.seconds),p=(0,l.Mn)(c);c.getFullYear()!==(new Date).getFullYear()&&b("Invalid year detected in the 10-day validity date range: ".concat(i[0].date_range)),g({months:p,date_start:c,date_range:i[0].date_range})}else{var f=_||"Weather data for the municipality is not available at the moment, however, you can continue viewing recommendations. Please verify that the municipality name is present in the 10-Day weather forecast.";_?(d([]),g(null),b(f)):y(f)}}}),[n,k,C,P,_]),{days:c,summary:f,loading:Z,error:x,warning:v}}}}]);